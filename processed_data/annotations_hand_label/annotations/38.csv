,text,token,annotation
0,"I need to validate a google id_token and one step involves to check the token signature. 

First I obtain the certificate from: https://www.googleapis.com/oauth2/v2/certs and extract the modulus (n) and exponent (e) part from the certificate and generate a public key, then I take apart the token (header, payload and digest), after then I send the decoded header.payload together with the Google pKey + digest to the rsa function rsa.VerifyPKCS1v15. 

I am stuck with this verification error: ","['I', 'need', 'to', 'validate', 'a', 'google', 'id_token', 'and', 'one', 'step', 'involves', 'to', 'check', 'the', 'token', 'signature.', 'First', 'I', 'obtain', 'the', 'certificate', 'from:', 'https://www.googleapis.com/oauth2/v2/certs', 'and', 'extract', 'the', 'modulus', '(n)', 'and', 'exponent', '(e)', 'part', 'from', 'the', 'certificate', 'and', 'generate', 'a', 'public', 'key,', 'then', 'I', 'take', 'apart', 'the', 'token', '(header,', 'payload', 'and', 'digest),', 'after', 'then', 'I', 'send', 'the', 'decoded', 'header.payload', 'together', 'with', 'the', 'Google', 'pKey', '+', 'digest', 'to', 'the', 'rsa', 'function', 'rsa.VerifyPKCS1v15.', 'I', 'am', 'stuck', 'with', 'this', 'verification', 'error:']","['PRP', 'VBP', 'TO', 'VB', 'DT', 'NN', 'NN', 'CC', 'CD', 'NN', 'VBZ', 'TO', 'VB', 'DT', 'NN', 'NN', 'NNP', 'PRP', 'VB', 'DT', 'NN', 'NN', 'NNS', 'CC', 'VB', 'DT', 'NN', 'NNP', 'CC', 'JJ', 'NNP', 'NN', 'IN', 'DT', 'NN', 'CC', 'VB', 'DT', 'JJ', 'NN', 'RB', 'PRP', 'VBP', 'RB', 'DT', 'JJ', 'NNP', 'NN', 'CC', 'NN', 'IN', 'RB', 'PRP', 'VBP', 'DT', 'JJ', 'NN', 'RB', 'IN', 'DT', 'NNP', 'NN', 'NNP', 'NN', 'TO', 'DT', 'NN', 'NN', 'NN', 'PRP', 'VBP', 'VBN', 'IN', 'DT', 'NN', 'NN']"
1,crypto/rsa: verification error,"['crypto/rsa:', 'verification', 'error']","['DIRECTORY', 'IDENTIFIER', 'IDENTIFIER']"
2,"

Here's the code (I commented part of code which fails with ","[""Here's"", 'the', 'code', '(I', 'commented', 'part', 'of', 'code', 'which', 'fails', 'with']","['NNP', 'DT', 'NN', 'NNP', 'VBD', 'NN', 'IN', 'NN', 'WDT', 'VBZ', 'IN']"
3,// validation here fails,"['//', 'validation', 'here', 'fails']","['COMMENT', 'NN', 'RB', 'VBZ']"
4,"):

",['):'],['NN']
5,func ValidateIDToken(auth_token string) (err error){    ,"['func', 'ValidateIDToken', '(', 'auth_token', 'string', ')', '(', 'err', 'error', '){']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR']"
6,"    res, err := http.Get(""https://www.googleapis.com/oauth2/v2/certs"")","['res', ',', 'err', ':=', 'http.Get(""https://www.googleapis.com/oauth2/v2/certs"")']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
7,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
8,        log.Fatal(err),['log.Fatal(err)'],['FUNCTION_CALL']
9,        return err,"['return', 'err']","['KEYWORD', 'IDENTIFIER']"
10,    },['}'],['OPERATOR']
11,"    certs, err := ioutil.ReadAll(res.Body)","['certs', ',', 'err', ':=', 'ioutil.ReadAll(res.Body)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
12,    res.Body.Close(),"['res', '.', 'Body.Close()']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
13,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
14,        log.Fatal(err),['log.Fatal(err)'],['FUNCTION_CALL']
15,        return err,"['return', 'err']","['KEYWORD', 'IDENTIFIER']"
16,    },['}'],['OPERATOR']
17,    //get modulus and exponent from the cert,"['//', 'get', 'modulus', 'and', 'exponent', 'from', 'the', 'cert']","['COMMENT', 'VB', 'JJ', 'CC', 'NN', 'IN', 'DT', 'NN']"
18,    var goCertificate interface{},"['var', 'go', 'Certificate', 'interface', '{}']","['KEYWORD', 'KEYWORD', 'IDENTIFIER', 'KEYWORD', 'OPERATOR']"
19,"    err = json.Unmarshal(certs, &goCertificate)    ","['err', '=', 'json.Unmarshal(certs, &goCertificate)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
20,"    k := goCertificate.(map[string]interface{})[""keys""]","['k', ':=', 'go', 'Certificate', '.(', 'map', '[', 'string', ']', 'interface', '{})[', '""keys""', ']']","['IDENTIFIER', 'OPERATOR', 'KEYWORD', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR']"
21,    j := k.([]interface{}),"['j', ':=', 'k', '.([]', 'interface', '{})']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR']"
22,    x := j[1],"['x', ':=', 'j', '[', '1', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
23,"    h := x.(map[string]interface{})[""n""]","['h', ':=', 'x', '.(', 'map', '[', 'string', ']', 'interface', '{})[', '""n""', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR']"
24,"    g := x.(map[string]interface{})[""e""]","['g', ':=', 'x', '.(', 'map', '[', 'string', ']', 'interface', '{})[', '""e""', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR']"
25,    e64 := base64.StdEncoding,"['e64', ':=', 'base64', '.', 'StdEncoding']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
26,    //build the google pub key,"['//', 'build', 'the', 'google', 'pub', 'key']","['COMMENT', 'VB', 'DT', 'NN', 'NN', 'NN']"
27,    nStr := h.(string),"['nStr', ':=', 'h', '.(', 'string', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
28,"    decN, err := base64.StdEncoding.DecodeString(nStr)","['decN', ',', 'err', ':=', 'base64', '.', 'StdEncoding.DecodeString(nStr)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
29,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
30,        log.Println(err),['log.Println(err)'],['FUNCTION_CALL']
31,        return,['return'],['KEYWORD']
32,    },['}'],['OPERATOR']
33,    n := big.NewInt(0),"['n', ':=', 'big.NewInt(0)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
34,    n.SetBytes(decN),['n.SetBytes(decN)'],['FUNCTION_CALL']
35,    eStr := g.(string),"['eStr', ':=', 'g', '.(', 'string', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
36,"    decE, err := base64.StdEncoding.DecodeString(eStr)","['decE', ',', 'err', ':=', 'base64', '.', 'StdEncoding.DecodeString(eStr)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
37,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
38,        log.Println(err),['log.Println(err)'],['FUNCTION_CALL']
39,        return,['return'],['KEYWORD']
40,    },['}'],['OPERATOR']
41,    var eBytes []byte,"['var', 'eBytes', '[]', 'byte']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
42,    if len(decE) < 8 {,"['if', 'len', '(', 'decE', ')', '<', '8', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
43,"        eBytes = make([]byte, 8-len(decE), 8)","['eBytes', '=', 'make', '([]', 'byte', ',', '8', '-', 'len', '(', 'decE', '),', '8', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
44,"        eBytes = append(eBytes, decE...)","['eBytes', '=', 'append', '(', 'eBytes', ',', 'decE', '...)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
45,    } else {,"['}', 'else', '{']","['OPERATOR', 'KEYWORD', 'OPERATOR']"
46,        eBytes = decE,"['eBytes', '=', 'decE']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
47,    },['}'],['OPERATOR']
48,    eReader := bytes.NewReader(eBytes),"['eReader', ':=', 'bytes.NewReader(eBytes)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
49,    var e uint64,"['var', 'e', 'uint64']","['KEYWORD', 'IDENTIFIER', 'IDENTIFIER']"
50,"    err = binary.Read(eReader, binary.BigEndian, &e)","['err', '=', 'binary.Read(eReader, binary.BigEndian, &e)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
51,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
52,        log.Println(err),['log.Println(err)'],['FUNCTION_CALL']
53,        return,['return'],['KEYWORD']
54,    },['}'],['OPERATOR']
55,"    pKey := rsa.PublicKey{N: n, E: int(e)}","['pKey', ':=', 'rsa', '.', 'PublicKey', '{', 'N', ':', 'n', ',', 'E', ':', 'int', '(', 'e', ')}']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
56,"    w := strings.SplitAfter(auth_token, ""."")    ","['w', ':=', 'strings.SplitAfter(auth_token, ""."")']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
57,"    for i, val := range w {","['for', 'i', ',', 'val', ':=', 'range', 'w', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'IDENTIFIER', 'OPERATOR']"
58,"        w[i] = strings.Trim(val, ""."")","['w', '[', 'i', ']', '=', 'strings.Trim(val, ""."")']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'FUNCTION_CALL']"
59,    },['}'],['OPERATOR']
60,    y := w[0:2],"['y', ':=', 'w', '[', '0', ':', '2', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OCTAL_LITERAL', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
61,"    //Join just the first two parts, the header and the payload without the signature","['//', 'Join', 'just', 'the', 'first', 'two', 'parts,', 'the', 'header', 'and', 'the', 'payload', 'without', 'the', 'signature']","['COMMENT', 'NNP', 'RB', 'DT', 'JJ', 'CD', 'VBP', 'DT', 'NN', 'CC', 'DT', 'NN', 'IN', 'DT', 'NN']"
62,"    o := strings.Join(y, ""."")   ","['o', ':=', 'strings.Join(y, ""."")']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
63,"    headerOauth := DecodeB64(nil,[]byte(w[0]),e64)","['headerOauth', ':=', 'DecodeB64', '(', 'nil', ',[]', 'byte', '(', 'w', '[', '0', ']),', 'e64', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OCTAL_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
64,"    inblockOauth := DecodeB64(nil,[]byte(w[1]),e64)","['inblockOauth', ':=', 'DecodeB64', '(', 'nil', ',[]', 'byte', '(', 'w', '[', '1', ']),', 'e64', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
65,"    toHash := string(headerOauth) + ""}."" + string(inblockOauth)","['toHash', ':=', 'string', '(', 'headerOauth', ')', '+', '""}.""', '+', 'string', '(', 'inblockOauth', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
66,"    digestOauth := DecodeB64(nil, []byte(w[2]),e64)","['digestOauth', ':=', 'DecodeB64', '(', 'nil', ',', '[]', 'byte', '(', 'w', '[', '2', ']),', 'e64', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
67,    hasherOauth := sha256.New(),"['hasherOauth', ':=', 'sha256.New()']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
68,    hasherOauth.Write([]byte(toHash)),['hasherOauth.Write([]byte(toHash))'],['FUNCTION_CALL']
69,    // validation here fails,"['//', 'validation', 'here', 'fails']","['COMMENT', 'NN', 'RB', 'VBZ']"
70,"    err = rsa.VerifyPKCS1v15(&pKey,crypto.SHA256,hasherOauth.Sum(nil),digestOauth)","['err', '=', 'rsa.VerifyPKCS1v15(&pKey,crypto.SHA256,hasherOauth.Sum(nil),digestOauth)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
71,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
72,"        log.Printf(""Error verifying key %s"",err.Error())","['log.Printf(""Error verifying key %s"",err.Error())']",['FUNCTION_CALL']
73,        return err,"['return', 'err']","['KEYWORD', 'IDENTIFIER']"
74,    },['}'],['OPERATOR']
75,    return err,"['return', 'err']","['KEYWORD', 'IDENTIFIER']"
76,},['}'],['OPERATOR']
77,"

UPDATE 1:
Here is toHash var which contains header and payload:

","['UPDATE', '1:', 'Here', 'is', 'toHash', 'var', 'which', 'contains', 'header', 'and', 'payload:']","['NN', 'CD', 'RB', 'VBZ', 'JJ', 'NN', 'WDT', 'VBZ', 'NN', 'CC', 'NN']"
78,"{""alg"":""RS256"",""kid"":""d91c503452d0f8849200a321ffbf7dea76f9371d""}.{""iss"":""accounts.google.com"",""sub"":""104869993929250743503"",""azp"":""client_email_till_@.apps.googleusercontent.com"",""email"":""test@test.hr"",""at_hash"":""KAm1M0g-ssMkdjds7jkbVQ"",""email_verified"":true,""aud"":client_email_till_@.apps.googleusercontent.com"",""hd"":""test.hr"",""iat"":1412246551,""exp"":1412250451}","['{', '""alg""', ':', '""RS256""', ',', '""kid""', ':', '""d91c503452d0f8849200a321ffbf7dea76f9371d""', '}.{', '""iss""', ':', '""accounts.google.com""', ',', '""sub""', ':', '""104869993929250743503""', ',', '""azp""', ':', '""client_email_till_@.apps.googleusercontent.com""', ',', '""email""', ':', '""test@test.hr""', ',', '""at_hash""', ':', '""KAm1M0g-ssMkdjds7jkbVQ""', ',', '""email_verified""', ':', 'true', ',', '""aud""', ':', 'client_email_till_', '.', 'apps', '.', 'go', 'ogleusercontent', '.', 'com', '"",""', 'hd', '"":""', 'test', '.', 'hr', '"",""', 'iat', '"":1412246551,""', 'exp', ':', '1412250451', '}']","['OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'STRING_LITERAL', 'IDENTIFIER', 'STRING_LITERAL', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'STRING_LITERAL', 'IDENTIFIER', 'STRING_LITERAL', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
79,"

UPDATE 2:
Thanks for the reply @Florent Morselli, I tried it again and it failed, I B64decoded this time only the third part (signature) but the error was still there, could someone test it with their
auth_token, just put the ID token in auth_token variable below in the code, and let me know if it worked, thank You.

","['UPDATE', '2:', 'Thanks', 'for', 'the', 'reply', '@Florent', 'Morselli,', 'I', 'tried', 'it', 'again', 'and', 'it', 'failed,', 'I', 'B64decoded', 'this', 'time', 'only', 'the', 'third', 'part', '(signature)', 'but', 'the', 'error', 'was', 'still', 'there,', 'could', 'someone', 'test', 'it', 'with', 'their', 'auth_token,', 'just', 'put', 'the', 'ID', 'token', 'in', 'auth_token', 'variable', 'below', 'in', 'the', 'code,', 'and', 'let', 'me', 'know', 'if', 'it', 'worked,', 'thank', 'You.']","['RB', 'CD', 'NNS', 'IN', 'DT', 'NN', 'JJ', 'NNP', 'PRP', 'VBD', 'PRP', 'RB', 'CC', 'PRP', 'VBD', 'PRP', 'VBD', 'DT', 'NN', 'RB', 'DT', 'JJ', 'NN', 'NN', 'CC', 'DT', 'NN', 'VBD', 'RB', 'VBN', 'MD', 'NN', 'VB', 'PRP', 'IN', 'PRP$', 'NN', 'RB', 'VBD', 'DT', 'NNP', 'NN', 'IN', 'JJ', 'JJ', 'IN', 'IN', 'DT', 'NN', 'CC', 'VB', 'PRP', 'VB', 'IN', 'PRP', 'VBD', 'JJ', 'NN']"
80,package main,"['package', 'main']","['KEYWORD', 'IDENTIFIER']"
81,import(,"['import', '(']","['KEYWORD', 'OPERATOR']"
82,"    ""strings""","['""strings""']",['STRING_LITERAL']
83,"    ""encoding/binary""","['""encoding/binary""']",['STRING_LITERAL']
84,"    ""errors""","['""errors""']",['STRING_LITERAL']
85,"    ""fmt""","['""fmt""']",['STRING_LITERAL']
86,"    ""log""","['""log""']",['STRING_LITERAL']
87,"    ""encoding/base64""","['""encoding/base64""']",['STRING_LITERAL']
88,"    ""io/ioutil""","['""io/ioutil""']",['STRING_LITERAL']
89,"    ""crypto""    ","['""crypto""']",['STRING_LITERAL']
90,"    ""crypto/sha256""","['""crypto/sha256""']",['STRING_LITERAL']
91,"    ""crypto/rsa""","['""crypto/rsa""']",['STRING_LITERAL']
92,"    ""bytes""","['""bytes""']",['STRING_LITERAL']
93,"    ""encoding/json""","['""encoding/json""']",['STRING_LITERAL']
94,"    ""net/http""","['""net/http""']",['STRING_LITERAL']
95,"    ""math/big""  ","['""math/big""']",['STRING_LITERAL']
96,),[')'],['OPERATOR']
97,func main() {,"['func', 'main', '()', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
98,"    auth_token := """"","['auth_token', ':=', '""""']","['IDENTIFIER', 'OPERATOR', 'STRING_LITERAL']"
99,"    w := strings.SplitAfter(auth_token, ""."")    ","['w', ':=', 'strings.SplitAfter(auth_token, ""."")']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
100,"    for i, val := range w {","['for', 'i', ',', 'val', ':=', 'range', 'w', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'IDENTIFIER', 'OPERATOR']"
101,"        w[i] = strings.Trim(val, ""."")","['w', '[', 'i', ']', '=', 'strings.Trim(val, ""."")']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'FUNCTION_CALL']"
102,    },['}'],['OPERATOR']
103,"    headerOauth, err := base64.URLEncoding.DecodeString(w[0])","['headerOauth', ',', 'err', ':=', 'base64', '.', 'URLEncoding.DecodeString(w[0])']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
104,"    res, err := http.Get(""https://www.googleapis.com/oauth2/v2/certs"")","['res', ',', 'err', ':=', 'http.Get(""https://www.googleapis.com/oauth2/v2/certs"")']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
105,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
106,        fmt.Println(err),['fmt.Println(err)'],['FUNCTION_CALL']
107,    },['}'],['OPERATOR']
108,"    certs, err := ioutil.ReadAll(res.Body)","['certs', ',', 'err', ':=', 'ioutil.ReadAll(res.Body)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
109,    res.Body.Close(),"['res', '.', 'Body.Close()']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
110,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
111,        fmt.Println(err),['fmt.Println(err)'],['FUNCTION_CALL']
112,    },['}'],['OPERATOR']
113,    //extract kid from token header,"['//', 'extract', 'kid', 'from', 'token', 'header']","['COMMENT', 'JJ', 'NN', 'IN', 'JJ', 'NN']"
114,    var header interface{},"['var', 'header', 'interface', '{}']","['KEYWORD', 'IDENTIFIER', 'KEYWORD', 'OPERATOR']"
115,"    err = json.Unmarshal([]byte(string(headerOauth)+""}""), &header)","['err', '=', 'json.Unmarshal([]byte(string(headerOauth)+""}""), &header)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
116,"    token_kid := header.(map[string]interface{})[""kid""]","['token_kid', ':=', 'header', '.(', 'map', '[', 'string', ']', 'interface', '{})[', '""kid""', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR']"
117,"    fmt.Println(""By 1"")","['fmt.Println(""By 1"")']",['FUNCTION_CALL']
118,    //get modulus and exponent from the cert,"['//', 'get', 'modulus', 'and', 'exponent', 'from', 'the', 'cert']","['COMMENT', 'VB', 'JJ', 'CC', 'NN', 'IN', 'DT', 'NN']"
119,    var goCertificate interface{},"['var', 'go', 'Certificate', 'interface', '{}']","['KEYWORD', 'KEYWORD', 'IDENTIFIER', 'KEYWORD', 'OPERATOR']"
120,"    err = json.Unmarshal(certs, &goCertificate)    ","['err', '=', 'json.Unmarshal(certs, &goCertificate)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
121,    //k := goCertificate.(map[string]interface{})[token_kid.(string)],"['//', 'k', ':=', 'goCertificate.(map[string]interface{})[token_kid.(string)]']","['COMMENT', 'NN', 'NNP', 'NN']"
122,"    k := goCertificate.(map[string]interface{})[""keys""]","['k', ':=', 'go', 'Certificate', '.(', 'map', '[', 'string', ']', 'interface', '{})[', '""keys""', ']']","['IDENTIFIER', 'OPERATOR', 'KEYWORD', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR']"
123,    ///*mod & exp part,"['//', '/*mod', '&', 'exp', 'part']","['COMMENT', 'NN', 'CC', 'JJ', 'NN']"
124,    j := k.([]interface{}),"['j', ':=', 'k', '.([]', 'interface', '{})']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR']"
125,    x := j[0],"['x', ':=', 'j', '[', '0', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OCTAL_LITERAL', 'OPERATOR']"
126,"    if j[0].(map[string]interface{})[""kid""] == token_kid {","['if', 'j', '[', '0', '].(', 'map', '[', 'string', ']', 'interface', '{})[', '""kid""', ']', '==', 'token_kid', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'OCTAL_LITERAL', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
127,        x = j[0],"['x', '=', 'j', '[', '0', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OCTAL_LITERAL', 'OPERATOR']"
128,    }else{,"['}', 'else', '{']","['OPERATOR', 'KEYWORD', 'OPERATOR']"
129,"        if j[1].(map[string]interface{})[""kid""] == token_kid {","['if', 'j', '[', '1', '].(', 'map', '[', 'string', ']', 'interface', '{})[', '""kid""', ']', '==', 'token_kid', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
130,            x = j[1],"['x', '=', 'j', '[', '1', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
131,        }else{,"['}', 'else', '{']","['OPERATOR', 'KEYWORD', 'OPERATOR']"
132,"            errors.New(""Token is not valid, kid from token and certificate don't match"")","['errors.New(""Token is not valid, kid from token and certificate don\'t match"")']",['FUNCTION_CALL']
133,        },['}'],['OPERATOR']
134,    },['}'],['OPERATOR']
135,"    h := x.(map[string]interface{})[""n""]","['h', ':=', 'x', '.(', 'map', '[', 'string', ']', 'interface', '{})[', '""n""', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR']"
136,"    g := x.(map[string]interface{})[""e""]","['g', ':=', 'x', '.(', 'map', '[', 'string', ']', 'interface', '{})[', '""e""', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR']"
137,    //build the google pub key,"['//', 'build', 'the', 'google', 'pub', 'key']","['COMMENT', 'VB', 'DT', 'NN', 'NN', 'NN']"
138,    nStr := h.(string),"['nStr', ':=', 'h', '.(', 'string', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
139,"    decN, err := base64.URLEncoding.DecodeString(nStr)","['decN', ',', 'err', ':=', 'base64', '.', 'URLEncoding.DecodeString(nStr)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
140,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
141,        fmt.Println(err),['fmt.Println(err)'],['FUNCTION_CALL']
142,        return,['return'],['KEYWORD']
143,    },['}'],['OPERATOR']
144,    n := big.NewInt(0),"['n', ':=', 'big.NewInt(0)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
145,    n.SetBytes(decN),['n.SetBytes(decN)'],['FUNCTION_CALL']
146,    eStr := g.(string),"['eStr', ':=', 'g', '.(', 'string', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
147,"    decE, err := base64.URLEncoding.DecodeString(eStr)","['decE', ',', 'err', ':=', 'base64', '.', 'URLEncoding.DecodeString(eStr)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
148,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
149,        fmt.Println(err),['fmt.Println(err)'],['FUNCTION_CALL']
150,        return,['return'],['KEYWORD']
151,    },['}'],['OPERATOR']
152,    var eBytes []byte,"['var', 'eBytes', '[]', 'byte']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
153,    if len(decE) < 8 {,"['if', 'len', '(', 'decE', ')', '<', '8', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
154,"        eBytes = make([]byte, 8-len(decE), 8)","['eBytes', '=', 'make', '([]', 'byte', ',', '8', '-', 'len', '(', 'decE', '),', '8', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
155,"        eBytes = append(eBytes, decE...)","['eBytes', '=', 'append', '(', 'eBytes', ',', 'decE', '...)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
156,    } else {,"['}', 'else', '{']","['OPERATOR', 'KEYWORD', 'OPERATOR']"
157,        eBytes = decE,"['eBytes', '=', 'decE']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
158,    },['}'],['OPERATOR']
159,    eReader := bytes.NewReader(eBytes),"['eReader', ':=', 'bytes.NewReader(eBytes)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
160,    var e uint64,"['var', 'e', 'uint64']","['KEYWORD', 'IDENTIFIER', 'IDENTIFIER']"
161,"    err = binary.Read(eReader, binary.BigEndian, &e)","['err', '=', 'binary.Read(eReader, binary.BigEndian, &e)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
162,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
163,        log.Println(err),['log.Println(err)'],['FUNCTION_CALL']
164,        return,['return'],['KEYWORD']
165,    },['}'],['OPERATOR']
166,"    pKey := rsa.PublicKey{N: n, E: int(e)}","['pKey', ':=', 'rsa', '.', 'PublicKey', '{', 'N', ':', 'n', ',', 'E', ':', 'int', '(', 'e', ')}']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
167,        //inblockOauth := base64.URLEncoding.DecodeString(w[1]),"['//', 'inblockOauth', ':=', 'base64.URLEncoding.DecodeString(w[1])']","['COMMENT', 'NN', 'CD', 'NN']"
168,"    toHash := w[0] + ""."" + w[1]","['toHash', ':=', 'w', '[', '0', ']', '+', '"".""', '+', 'w', '[', '1', ']']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OCTAL_LITERAL', 'OPERATOR', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
169,"    digestOauth, err := base64.URLEncoding.DecodeString(w[2])","['digestOauth', ',', 'err', ':=', 'base64', '.', 'URLEncoding.DecodeString(w[2])']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
170,    hasherOauth := sha256.New(),"['hasherOauth', ':=', 'sha256.New()']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
171,    hasherOauth.Write([]byte(toHash)),['hasherOauth.Write([]byte(toHash))'],['FUNCTION_CALL']
172,    // verification here fails,"['//', 'verification', 'here', 'fails']","['COMMENT', 'NN', 'RB', 'VBZ']"
173,"    err = rsa.VerifyPKCS1v15(&pKey,crypto.SHA256,hasherOauth.Sum(nil),digestOauth)","['err', '=', 'rsa.VerifyPKCS1v15(&pKey,crypto.SHA256,hasherOauth.Sum(nil),digestOauth)']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
174,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
175,"        fmt.Printf(""Error verifying key %s"",err.Error())","['fmt.Printf(""Error verifying key %s"",err.Error())']",['FUNCTION_CALL']
176,    },['}'],['OPERATOR']
177,},['}'],['OPERATOR']
