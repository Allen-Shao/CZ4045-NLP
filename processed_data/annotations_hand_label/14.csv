,text,token,annotation
0,"There are 2 major problems with this code.


You are not handling the client stalling or using keep alives (handled below by getTimeoutServer)
You are not handling the server (what your http.Client is talking to) timing out (handled below by TimeoutConn).


This is probably why you are exhausting your local ports. I know from past experience node.js will keep-alive you very aggressively.

There are lots of little issues, creating objects every-time when you don't need to. Creating unneeded goroutines (each incoming request is in its own goroutine before you handle it).

Here is a quick stab (that I don't have time to test well). Hopefully it will put you on the right track: (You will want to upgrade this to not buffer the responses locally)

","['There', 'are', '2', 'major', 'problems', 'with', 'this', 'code.', 'You', 'are', 'not', 'handling', 'the', 'client', 'stalling', 'or', 'using', 'keep', 'alives', '(handled', 'below', 'by', 'getTimeoutServer)', 'You', 'are', 'not', 'handling', 'the', 'server', '(what', 'your', 'http.Client', 'is', 'talking', 'to)', 'timing', 'out', '(handled', 'below', 'by', 'TimeoutConn).', 'This', 'is', 'probably', 'why', 'you', 'are', 'exhausting', 'your', 'local', 'ports.', 'I', 'know', 'from', 'past', 'experience', 'node.js', 'will', 'keep-alive', 'you', 'very', 'aggressively.', 'There', 'are', 'lots', 'of', 'little', 'issues,', 'creating', 'objects', 'every-time', 'when', 'you', ""don't"", 'need', 'to.', 'Creating', 'unneeded', 'goroutines', '(each', 'incoming', 'request', 'is', 'in', 'its', 'own', 'goroutine', 'before', 'you', 'handle', 'it).', 'Here', 'is', 'a', 'quick', 'stab', '(that', 'I', ""don't"", 'have', 'time', 'to', 'test', 'well).', 'Hopefully', 'it', 'will', 'put', 'you', 'on', 'the', 'right', 'track:', '(You', 'will', 'want', 'to', 'upgrade', 'this', 'to', 'not', 'buffer', 'the', 'responses', 'locally)']","['EX', 'VBP', 'CD', 'JJ', 'NNS', 'IN', 'DT', 'NN', 'PRP', 'VBP', 'RB', 'VBG', 'DT', 'NN', 'NN', 'CC', 'VBG', 'JJ', 'NNS', 'VBN', 'IN', 'IN', 'NN', 'PRP', 'VBP', 'RB', 'VBG', 'DT', 'NN', 'IN', 'PRP$', 'NN', 'VBZ', 'VBG', 'JJ', 'VBG', 'RP', 'VBN', 'IN', 'IN', 'NNP', 'DT', 'VBZ', 'RB', 'WRB', 'PRP', 'VBP', 'VBG', 'PRP$', 'JJ', 'NN', 'PRP', 'VBP', 'IN', 'JJ', 'NN', 'NN', 'MD', 'VB', 'PRP', 'RB', 'IN', 'EX', 'VBP', 'NNS', 'IN', 'JJ', 'JJ', 'VBG', 'NNS', 'RB', 'WRB', 'PRP', 'VBP', 'VB', 'JJ', 'NNP', 'JJ', 'NNS', 'VBP', 'VBG', 'NN', 'VBZ', 'IN', 'PRP$', 'JJ', 'NN', 'IN', 'PRP', 'VBP', 'VB', 'RB', 'VBZ', 'DT', 'JJ', 'NN', 'WP', 'PRP', 'VBP', 'VB', 'NN', 'TO', 'VB', 'NN', 'NNP', 'PRP', 'MD', 'VB', 'PRP', 'IN', 'DT', 'JJ', 'NN', 'NNP', 'MD', 'VB', 'TO', 'VB', 'DT', 'TO', 'RB', 'VB', 'DT', 'NNS', 'VBP']"
1,package main,"['package', 'main']","['KEYWORD', 'IDENTIFIER']"
2,import (,"['import', '(']","['KEYWORD', 'OPERATOR']"
3,"    ""bytes""","['""bytes""']",['STRING_LITERAL']
4,"    ""errors""","['""errors""']",['STRING_LITERAL']
5,"    ""flag""","['""flag""']",['STRING_LITERAL']
6,"    ""fmt""","['""fmt""']",['STRING_LITERAL']
7,"    ""log""","['""log""']",['STRING_LITERAL']
8,"    ""net""","['""net""']",['STRING_LITERAL']
9,"    ""net/http""","['""net/http""']",['STRING_LITERAL']
10,"    ""net/url""","['""net/url""']",['STRING_LITERAL']
11,"    ""runtime""","['""runtime""']",['STRING_LITERAL']
12,"    ""strconv""","['""strconv""']",['STRING_LITERAL']
13,"    ""time""","['""time""']",['STRING_LITERAL']
14,),[')'],['OPERATOR']
15,const DEFAULT_IDLE_TIMEOUT = 5 * time.Second,"['const', 'DEFAULT_IDLE_TIMEOUT', '=', '5', '*', 'time', '.', 'Second']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
16,var (,"['var', '(']","['KEYWORD', 'OPERATOR']"
17,    listen       string,"['listen', 'string']","['IDENTIFIER', 'IDENTIFIER']"
18,    logOn        bool,"['logOn', 'bool']","['IDENTIFIER', 'IDENTIFIER']"
19,"    localhost, _ = url.Parse(""http://localhost:8080/"")","['localhost', ',', '_', '=', 'url.Parse(""http://localhost:8080/"")']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
20,    client       = &http.Client{,"['client', '=', '&', 'http', '.', 'Client', '{']","['IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
21,        Transport: &http.Transport{,"['Transport', ':', '&', 'http', '.', 'Transport', '{']","['IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
22,"            Proxy: NoProxyAllowed,","['Proxy', ':', 'NoProxyAllowed', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
23,"            Dial: func(network, addr string) (net.Conn, error) {","['Dial', ':', 'func', '(', 'network', ',', 'addr', 'string', ')', '(', 'net', '.', 'Conn', ',', 'error', ')', '{']","['IDENTIFIER', 'OPERATOR', 'KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
24,"                return NewTimeoutConnDial(network, addr, DEFAULT_IDLE_TIMEOUT)","['return', 'NewTimeoutConnDial', '(', 'network', ',', 'addr', ',', 'DEFAULT_IDLE_TIMEOUT', ')']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
25,"            },","['},']",['OPERATOR']
26,"        },","['},']",['OPERATOR']
27,    },['}'],['OPERATOR']
28,),[')'],['OPERATOR']
29,func main() {,"['func', 'main', '()', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
30,    runtime.GOMAXPROCS(runtime.NumCPU()),['runtime.GOMAXPROCS(runtime.NumCPU())'],['FUNCTION_CALL']
31,"    flag.StringVar(&listen, ""listen"", ""0.0.0.0:9000"", ""listen on address"")","['flag.StringVar(&listen, ""listen"", ""0.0.0.0:9000"", ""listen on address"")']",['FUNCTION_CALL']
32,"    flag.BoolVar(&logOn, ""log"", true, ""enable logging"")","['flag.BoolVar(&logOn, ""log"", true, ""enable logging"")']",['FUNCTION_CALL']
33,    flag.Parse(),['flag.Parse()'],['FUNCTION_CALL']
34,"    server := getTimeoutServer(listen, http.HandlerFunc(proxyHandlerFunc))","['server', ':=', 'getTimeoutServer', '(', 'listen', ',', 'http.HandlerFunc(proxyHandlerFunc))']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
35,"    log.Printf(""Starting router-server on %s\n"", listen)","['log.Printf(""Starting router-server on %s\\n"", listen)']",['FUNCTION_CALL']
36,    log.Fatal(server.ListenAndServe()),['log.Fatal(server.ListenAndServe())'],['FUNCTION_CALL']
37,},['}'],['OPERATOR']
38,"func proxyHandlerFunc(w http.ResponseWriter, req *http.Request) {","['func', 'proxyHandlerFunc', '(', 'w', 'http', '.', 'ResponseWriter', ',', 'req', '*', 'http', '.', 'Request', ')', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
39,    if logOn {,"['if', 'logOn', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR']"
40,"        log.Printf(""%+v\n"", req)","['log.Printf(""%+v\\n"", req)']",['FUNCTION_CALL']
41,    },['}'],['OPERATOR']
42,    // Setup request URL,"['//', 'Setup', 'request', 'URL']","['COMMENT', 'NNP', 'NN', 'NN']"
43,    origURL := req.URL,"['origURL', ':=', 'req', '.', 'URL']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
44,    req.URL = new(url.URL),"['req', '.', 'URL', '=', 'new', '(', 'url', '.', 'URL', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
45,    *req.URL = *localhost,"['*', 'req', '.', 'URL', '=', '*', 'localhost']","['OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER']"
46,"    req.URL.Path, req.URL.RawQuery, req.URL.Fragment = origURL.Path, origURL.RawQuery, origURL.Fragment","['req', '.', 'URL', '.', 'Path', ',', 'req', '.', 'URL', '.', 'RawQuery', ',', 'req', '.', 'URL', '.', 'Fragment', '=', 'origURL', '.', 'Path', ',', 'origURL', '.', 'RawQuery', ',', 'origURL', '.', 'Fragment']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
47,"    req.RequestURI, req.Host = """", req.URL.Host","['req', '.', 'RequestURI', ',', 'req', '.', 'Host', '=', '""""', ',', 'req', '.', 'URL', '.', 'Host']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'STRING_LITERAL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
48,    // Perform request,"['//', 'Perform', 'request']","['COMMENT', 'VB', 'NN']"
49,"    resp, err := client.Do(req)","['resp', ',', 'err', ':=', 'client.Do(req)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
50,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
51,        w.WriteHeader(http.StatusBadGateway),['w.WriteHeader(http.StatusBadGateway)'],['FUNCTION_CALL']
52,"        w.Write([]byte(fmt.Sprintf(""%d - StatusBadGateway: %s"", http.StatusBadGateway, err)))","['w.Write([]byte(fmt.Sprintf(""%d - StatusBadGateway: %s"", http.StatusBadGateway, err)))']",['FUNCTION_CALL']
53,        return,['return'],['KEYWORD']
54,    },['}'],['OPERATOR']
55,    defer resp.Body.Close(),"['defer', 'resp', '.', 'Body.Close()']","['IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
56,    var respBuffer *bytes.Buffer,"['var', 'respBuffer', '*', 'bytes', '.', 'Buffer']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
57,    if resp.ContentLength != -1 {,"['if', 'resp', '.', 'ContentLength', '!=', '-', '1', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'DECIMAL_LITERAL', 'OPERATOR']"
58,"        respBuffer = bytes.NewBuffer(make([]byte, 0, resp.ContentLength))","['respBuffer', '=', 'bytes.NewBuffer(make([]byte, 0, resp.ContentLength))']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
59,    } else {,"['}', 'else', '{']","['OPERATOR', 'KEYWORD', 'OPERATOR']"
60,        respBuffer = new(bytes.Buffer),"['respBuffer', '=', 'new', '(', 'bytes', '.', 'Buffer', ')']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
61,    },['}'],['OPERATOR']
62,"    if _, err = respBuffer.ReadFrom(resp.Body); err != nil {","['if', '_', ',', 'err', '=', 'respBuffer.ReadFrom(resp.Body)', ';', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
63,        w.WriteHeader(http.StatusBadGateway),['w.WriteHeader(http.StatusBadGateway)'],['FUNCTION_CALL']
64,"        w.Write([]byte(fmt.Sprintf(""%d - StatusBadGateway: %s"", http.StatusBadGateway, err)))","['w.Write([]byte(fmt.Sprintf(""%d - StatusBadGateway: %s"", http.StatusBadGateway, err)))']",['FUNCTION_CALL']
65,        return,['return'],['KEYWORD']
66,    },['}'],['OPERATOR']
67,    // Write result of request,"['//', 'Write', 'result', 'of', 'request']","['COMMENT', 'NNP', 'NN', 'IN', 'NN']"
68,    headers := w.Header(),"['headers', ':=', 'w.Header()']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
69,    var key string,"['var', 'key', 'string']","['KEYWORD', 'IDENTIFIER', 'IDENTIFIER']"
70,    var val []string,"['var', 'val', '[]', 'string']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
71,"    for key, val = range resp.Header {","['for', 'key', ',', 'val', '=', 'range', 'resp', '.', 'Header', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
72,        headers[key] = val,"['headers', '[', 'key', ']', '=', 'val']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER']"
73,    },['}'],['OPERATOR']
74,"    headers.Set(""Content-Length"", strconv.Itoa(respBuffer.Len()))","['headers.Set(""Content-Length"", strconv.Itoa(respBuffer.Len()))']",['FUNCTION_CALL']
75,    w.WriteHeader(resp.StatusCode),['w.WriteHeader(resp.StatusCode)'],['FUNCTION_CALL']
76,    w.Write(respBuffer.Bytes()),['w.Write(respBuffer.Bytes())'],['FUNCTION_CALL']
77,},['}'],['OPERATOR']
78,"func getTimeoutServer(addr string, handler http.Handler) *http.Server {","['func', 'getTimeoutServer', '(', 'addr', 'string', ',', 'handler', 'http', '.', 'Handler', ')', '*', 'http', '.', 'Server', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
79,    //keeps people who are slow or are sending keep-alives from eating all our sockets,"['//', 'keeps', 'people', 'who', 'are', 'slow', 'or', 'are', 'sending', 'keep-alives', 'from', 'eating', 'all', 'our', 'sockets']","['COMMENT', 'NNS', 'NNS', 'WP', 'VBP', 'JJ', 'CC', 'VBP', 'VBG', 'NNS', 'IN', 'VBG', 'DT', 'PRP$', 'NNS']"
80,    const (,"['const', '(']","['KEYWORD', 'OPERATOR']"
81,        HTTP_READ_TO  = DEFAULT_IDLE_TIMEOUT,"['HTTP_READ_TO', '=', 'DEFAULT_IDLE_TIMEOUT']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
82,        HTTP_WRITE_TO = DEFAULT_IDLE_TIMEOUT,"['HTTP_WRITE_TO', '=', 'DEFAULT_IDLE_TIMEOUT']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
83,    ),[')'],['OPERATOR']
84,    return &http.Server{,"['return', '&', 'http', '.', 'Server', '{']","['KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
85,"        Addr:         addr,","['Addr', ':', 'addr', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
86,"        Handler:      handler,","['Handler', ':', 'handler', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
87,"        ReadTimeout:  HTTP_READ_TO,","['ReadTimeout', ':', 'HTTP_READ_TO', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
88,"        WriteTimeout: HTTP_WRITE_TO,","['WriteTimeout', ':', 'HTTP_WRITE_TO', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
89,    },['}'],['OPERATOR']
90,},['}'],['OPERATOR']
91,"func NoProxyAllowed(request *http.Request) (*url.URL, error) {","['func', 'NoProxyAllowed', '(', 'request', '*', 'http', '.', 'Request', ')', '(*', 'url', '.', 'URL', ',', 'error', ')', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
92,"    return nil, nil","['return', 'nil', ',', 'nil']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
93,},['}'],['OPERATOR']
94,//TimeoutConn-------------------------,"['//', 'TimeoutConn-------------------------']","['COMMENT', 'NN']"
95,//Put me in my own TimeoutConn.go ?,"['//', 'Put', 'me', 'in', 'my', 'own', 'TimeoutConn.go', '?']","['COMMENT', 'VB', 'PRP', 'IN', 'PRP$', 'JJ', 'NNP', '.']"
96,type TimeoutConn struct {,"['type', 'TimeoutConn', 'struct', '{']","['KEYWORD', 'IDENTIFIER', 'KEYWORD', 'OPERATOR']"
97,    net.Conn,"['net', '.', 'Conn']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
98,"    readTimeout, writeTimeout time.Duration","['readTimeout', ',', 'writeTimeout', 'time', '.', 'Duration']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
99,},['}'],['OPERATOR']
100,"var invalidOperationError = errors.New(""TimeoutConn does not support or allow .SetDeadline operations"")","['var', 'invalidOperationError', '=', 'errors.New(""TimeoutConn does not support or allow .SetDeadline operations"")']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
101,"func NewTimeoutConn(conn net.Conn, ioTimeout time.Duration) (*TimeoutConn, error) {","['func', 'NewTimeoutConn', '(', 'conn', 'net', '.', 'Conn', ',', 'ioTimeout', 'time', '.', 'Duration', ')', '(*', 'TimeoutConn', ',', 'error', ')', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
102,"    return NewTimeoutConnReadWriteTO(conn, ioTimeout, ioTimeout)","['return', 'NewTimeoutConnReadWriteTO', '(', 'conn', ',', 'ioTimeout', ',', 'ioTimeout', ')']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
103,},['}'],['OPERATOR']
104,"func NewTimeoutConnReadWriteTO(conn net.Conn, readTimeout, writeTimeout time.Duration) (*TimeoutConn, error) {","['func', 'NewTimeoutConnReadWriteTO', '(', 'conn', 'net', '.', 'Conn', ',', 'readTimeout', ',', 'writeTimeout', 'time', '.', 'Duration', ')', '(*', 'TimeoutConn', ',', 'error', ')', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
105,    this := &TimeoutConn{,"['this', ':=', '&', 'TimeoutConn', '{']","['IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
106,"        Conn:         conn,","['Conn', ':', 'conn', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
107,"        readTimeout:  readTimeout,","['readTimeout', ':', 'readTimeout', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
108,"        writeTimeout: writeTimeout,","['writeTimeout', ':', 'writeTimeout', ',']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
109,    },['}'],['OPERATOR']
110,    now := time.Now(),"['now', ':=', 'time.Now()']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
111,    err := this.Conn.SetReadDeadline(now.Add(this.readTimeout)),"['err', ':=', 'this', '.', 'Conn.SetReadDeadline(now.Add(this.readTimeout))']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
112,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
113,"        return nil, err","['return', 'nil', ',', 'err']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
114,    },['}'],['OPERATOR']
115,    err = this.Conn.SetWriteDeadline(now.Add(this.writeTimeout)),"['err', '=', 'this', '.', 'Conn.SetWriteDeadline(now.Add(this.writeTimeout))']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
116,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
117,"        return nil, err","['return', 'nil', ',', 'err']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
118,    },['}'],['OPERATOR']
119,"    return this, nil","['return', 'this', ',', 'nil']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
120,},['}'],['OPERATOR']
121,"func NewTimeoutConnDial(network, addr string, ioTimeout time.Duration) (net.Conn, error) {","['func', 'NewTimeoutConnDial', '(', 'network', ',', 'addr', 'string', ',', 'ioTimeout', 'time', '.', 'Duration', ')', '(', 'net', '.', 'Conn', ',', 'error', ')', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
122,"    conn, err := net.DialTimeout(network, addr, ioTimeout)","['conn', ',', 'err', ':=', 'net.DialTimeout(network, addr, ioTimeout)']","['IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
123,    if err != nil {,"['if', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
124,"        return nil, err","['return', 'nil', ',', 'err']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
125,    },['}'],['OPERATOR']
126,"    if conn, err = NewTimeoutConn(conn, ioTimeout); err != nil {","['if', 'conn', ',', 'err', '=', 'NewTimeoutConn', '(', 'conn', ',', 'ioTimeout', ');', 'err', '!=', 'nil', '{']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
127,"        return nil, err","['return', 'nil', ',', 'err']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
128,    },['}'],['OPERATOR']
129,"    return conn, nil","['return', 'conn', ',', 'nil']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER']"
130,},['}'],['OPERATOR']
131,"func (this *TimeoutConn) Read(data []byte) (int, error) {","['func', '(', 'this', '*', 'TimeoutConn', ')', 'Read', '(', 'data', '[]', 'byte', ')', '(', 'int', ',', 'error', ')', '{']","['KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
132,    this.Conn.SetReadDeadline(time.Now().Add(this.readTimeout)),"['this', '.', 'Conn.SetReadDeadline(time.Now().Add(this.readTimeout))']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
133,    return this.Conn.Read(data),"['return', 'this', '.', 'Conn.Read(data)']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
134,},['}'],['OPERATOR']
135,"func (this *TimeoutConn) Write(data []byte) (int, error) {","['func', '(', 'this', '*', 'TimeoutConn', ')', 'Write', '(', 'data', '[]', 'byte', ')', '(', 'int', ',', 'error', ')', '{']","['KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'OPERATOR']"
136,    this.Conn.SetWriteDeadline(time.Now().Add(this.writeTimeout)),"['this', '.', 'Conn.SetWriteDeadline(time.Now().Add(this.writeTimeout))']","['IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
137,    return this.Conn.Write(data),"['return', 'this', '.', 'Conn.Write(data)']","['KEYWORD', 'IDENTIFIER', 'OPERATOR', 'FUNCTION_CALL']"
138,},['}'],['OPERATOR']
139,func (this *TimeoutConn) SetDeadline(time time.Time) error {,"['func', '(', 'this', '*', 'TimeoutConn', ')', 'SetDeadline', '(', 'time', 'time', '.', 'Time', ')', 'error', '{']","['KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
140,    return invalidOperationError,"['return', 'invalidOperationError']","['KEYWORD', 'IDENTIFIER']"
141,},['}'],['OPERATOR']
142,func (this *TimeoutConn) SetReadDeadline(time time.Time) error {,"['func', '(', 'this', '*', 'TimeoutConn', ')', 'SetReadDeadline', '(', 'time', 'time', '.', 'Time', ')', 'error', '{']","['KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
143,    return invalidOperationError,"['return', 'invalidOperationError']","['KEYWORD', 'IDENTIFIER']"
144,},['}'],['OPERATOR']
145,func (this *TimeoutConn) SetWriteDeadline(time time.Time) error {,"['func', '(', 'this', '*', 'TimeoutConn', ')', 'SetWriteDeadline', '(', 'time', 'time', '.', 'Time', ')', 'error', '{']","['KEYWORD', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR', 'IDENTIFIER', 'OPERATOR']"
146,    return invalidOperationError,"['return', 'invalidOperationError']","['KEYWORD', 'IDENTIFIER']"
147,},['}'],['OPERATOR']
